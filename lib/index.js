"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var keyMap={Enter:"\n",Tab:"\t",// Older browsers may return "Spacebar" instead of " "
// According to https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values
Spacebar:" ",Backspace:"\b",Delete:"\0x7F"},Recorder=/*#__PURE__*/function(){function a(){_classCallCheck(this,a),this.events=[],this.startTime=null,this.lastDownUpperCase=[],this.keysDown={}}return _createClass(a,[{key:"handleEvent",value:function handleEvent(a){var b=Math.round,c=performance.now();if(["keydown","keyup"].includes(a.type)){null===this.startTime&&(this.startTime=c);var d="";if(1===a.key.length)d=a.key,a.shiftKey&&(d=d.toUpperCase());else if(keyMap.hasOwnProperty(a.key))d=keyMap[a.key];else// If key length > 1 and not in keyMap, ignore it
return;// Prevent repetitive keydowns
if("keydown"===a.type){if(!0===this.keysDown[d.toLowerCase()])return void console.log("Block rep");this.keysDown[d.toLowerCase()]=!0}else this.keysDown[d.toLowerCase()]=!1;// Handle correct up case
"keyup"===a.type?(this.lastDownUpperCase.includes(d.toUpperCase())&&(d=d.toUpperCase()),this.lastDownUpperCase.splice(this.lastDownUpperCase.indexOf(d),1)):(this.lastDownUpperCase.splice(this.lastDownUpperCase.indexOf(d),1),d===d.toUpperCase()&&this.lastDownUpperCase.push(d)),this.events.push({kind:a.type,key:d,timestamp:b(c-this.startTime)})}}},{key:"track",value:function track(a){var b=this;a.addEventListener("keydown",function(a){return b.handleEvent.call(b,a)}),a.addEventListener("keyup",function(a){return b.handleEvent.call(b,a)})}},{key:"untrack",value:function untrack(){// Perhaps someone will implement this later
}},{key:"reset",value:function reset(){this.events=[],this.startTime=null,this.lastDownUpperCase=[],this.keysDown={}}},{key:"exportV1",value:function exportV1(){var a="";return this.events.forEach(function(b){a+=("keydown"===b.kind?"d":"u")+b.key+b.timestamp}),a}}]),a}();